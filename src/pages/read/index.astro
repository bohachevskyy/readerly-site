---
import BaseLayout from "../../layouts/BaseLayout.astro";
import { allStories } from "../../data/stories";

const stories = allStories();

const LANGUAGE_LABELS: Record<string, string> = {
  es: "Español",
  uk: "Українська",
  fr: "Français",
  de: "Deutsch",
  pt: "Português",
  it: "Italiano",
  pl: "Polski",
  ja: "日本語",
  ko: "한국어",
  zh: "中文",
};

function getLanguageLabel(code: string): string {
  return LANGUAGE_LABELS[code] ?? code.toUpperCase();
}
---

<BaseLayout
  title="Read Stories — Readerly"
  description="Browse short English stories with instant word translations. Click any word to see its meaning in your language."
>
  <header class="border-b border-emerald-100 bg-white">
    <nav class="container flex items-center justify-between py-6">
      <div class="flex items-center gap-3 text-lg font-semibold text-ink">
        <a href="/" class="flex items-center gap-3 hover:opacity-80 transition">
          <span class="flex h-9 w-9 items-center justify-center rounded-full bg-ink text-white">
            R
          </span>
          Readerly
        </a>
      </div>
      <a
        class="rounded-full border border-emerald-200 px-5 py-2 text-sm font-medium text-ink transition hover:border-emerald-400"
        href="https://app.readerly.ai"
        target="_blank"
        rel="noopener"
      >
        Open Readerly
      </a>
    </nav>
  </header>

  <main class="min-h-screen bg-white">
    <section class="container py-16">
      <div class="max-w-2xl mx-auto text-center mb-12">
        <p class="text-sm font-semibold uppercase tracking-[0.2em] text-accent">
          Try it now
        </p>
        <h1 class="mt-3 text-4xl font-semibold text-ink">
          Read a story
        </h1>
        <p class="mt-4 text-lg text-muted">
          Pick a story and click on any word to see its translation. A taste of the Readerly experience, right in your browser.
        </p>
      </div>

      {stories.length === 0 ? (
        <p class="text-center text-muted">No stories available yet. Check back soon!</p>
      ) : (
        <div class="grid gap-6 sm:grid-cols-2 lg:grid-cols-3 max-w-5xl mx-auto">
          {stories.map((story) => (
            <a
              href={`/read/${story.slug}/`}
              class="group rounded-2xl border border-emerald-100 bg-white p-6 shadow-soft transition hover:border-emerald-300 hover:shadow-md"
            >
              <div class="flex items-center gap-2 mb-3">
                {story.level && (
                  <span class="rounded-full bg-emerald-100 px-2.5 py-0.5 text-xs font-semibold text-emerald-700">
                    {story.level}
                  </span>
                )}
                <div class="flex gap-1">
                  {Object.keys(story.translations).map((lang) => (
                    <span class="rounded-full bg-soft px-2 py-0.5 text-[10px] font-medium text-muted uppercase">
                      {lang}
                    </span>
                  ))}
                </div>
              </div>
              <h2 class="text-lg font-semibold text-ink group-hover:text-emerald-700 transition-colors">
                {story.title}
              </h2>
              <p class="mt-2 text-sm text-muted leading-relaxed">
                {story.description}
              </p>
              <p class="mt-4 text-sm font-medium text-emerald-600 group-hover:text-emerald-700 transition-colors inline-flex items-center gap-1">
                Start reading
                <svg xmlns="http://www.w3.org/2000/svg" class="h-4 w-4 transition-transform group-hover:translate-x-0.5" fill="none" viewBox="0 0 24 24" stroke="currentColor" stroke-width="2">
                  <path stroke-linecap="round" stroke-linejoin="round" d="M9 5l7 7-7 7" />
                </svg>
              </p>
            </a>
          ))}
        </div>
      )}
    </section>

    <!-- CTA Section -->
    <section class="bg-emerald-50 border-t border-emerald-100">
      <div class="container py-12 text-center">
        <h2 class="text-2xl font-semibold text-ink">
          Ready to build your vocabulary?
        </h2>
        <p class="mt-3 text-muted max-w-lg mx-auto">
          Save words from any story and practice them with spaced repetition in the Readerly app — completely free.
        </p>
        <div class="mt-6">
          <a
            href="https://app.readerly.ai"
            target="_blank"
            rel="noopener"
            class="inline-flex items-center justify-center rounded-full bg-emerald-500 px-6 py-3 text-sm font-semibold text-white shadow-soft transition hover:bg-emerald-600"
          >
            Open Readerly App
          </a>
        </div>
      </div>
    </section>
  </main>

  <footer class="border-t border-emerald-100 bg-white">
    <div class="container flex flex-col items-start justify-between gap-4 py-8 text-sm text-muted sm:flex-row sm:items-center">
      <p>&copy; {new Date().getFullYear()} Readerly</p>
      <div class="flex gap-4">
        <a class="hover:text-ink" href="mailto:hello@readerly.ai">Contact</a>
        <span>Privacy available on request</span>
      </div>
    </div>
  </footer>
</BaseLayout>
